#!/bin/bash
# Test bracket selection for all 208 FNO symbols

echo "ðŸŽ¯ Testing Bracket Selection for All 208 FNO Symbols"
echo "====================================================\n"

# Create a JSON object with all 208 symbols and sample prices
# Using base prices scaled by symbol order for variety

SYMBOLS=(
  "RELIANCE:1350.5"
  "TCS:3500"
  "INFY:2800"
  "HDFC:2450"
  "ICICI:950"
  "SBIN:550"
  "HDFC_BANK:1650"
  "LT:2100"
  "ONGC:300"
  "MARUTI:11000"
  "BAJAJ_AUTO:9500"
  "ASHOK_LEYLAND:250"
  "AUBANK:650"
  "BANKNIFTY:50000"
  "NIFTY:23000"
  "ACC:2800"
  "ADANIGREEN:1250"
  "ADANIPORTS:950"
  "ALLCARGO:550"
  "AMBUJACEM:600"
  "APOLLOHOSP:6500"
  "ASIANPAINT:3100"
  "ASTRAL:2400"
  "ATUL:10000"
  "AUROPHARMA:1250"
  "AXISBANK:1150"
  "BAJAJFINSV:1450"
  "BERGEPAINT:450"
  "BLS:550"
  "BPCL:350"
  "CAPLIPOINT:1200"
  "CGCONSTRUCT:1100"
  "CIPLA:1400"
  "COALINDIA:350"
  "COFORGE:5500"
  "COLPAL:750"
  "CONCOR:650"
  "CUMMINSIND:2700"
  "DABUR:650"
  "DELHIVERY:500"
  "DIVISLAB:5500"
  "DLF:850"
  "DMART:3600"
  "DRREDDY:6700"
  "EICHERMOT:5000"
  "ESCORTS:3500"
  "EXIDEIND:420"
  "FEDERALBNK:180"
  "GAIL:200"
  "GICRE:330"
  "GLAND:1550"
  "GLDREIT:380"
  "GMRINFRA:70"
  "GODREJCP:1050"
  "GODREJPROP:2200"
  "GRANULES:550"
  "GRASIM:2300"
  "GRINDWELL:2100"
  "GROVY:4900"
  "GUJGASLTD:700"
  "HAPPSTMNDS:1700"
  "HDFCBANK:1650"
  "HDFCLIFE:600"
  "HEROMOTOCO:4100"
  "HEXAWARE:550"
  "HINDCOPPER:200"
  "HINDPETRO:350"
  "HINDUNILVR:2350"
  "HONAUT:69000"
  "HUL:2400"
  "IBREALEST:150"
  "IDBANKLTD:110"
  "IDFCFIRSTB:90"
  "IDFC:150"
  "IFBIND:1350"
  "IGARASHI:3300"
  "IINDIGO:3550"
  "ITC:430"
  "ITDC:650"
  "ITMCORP:10"
  "JBCHEPHARM:1800"
  "JINDALSTEL:750"
  "JKCEMENT:3200"
  "JKLAKSHMIQ:700"
  "JKPAPER:550"
  "JKTYRE:180"
  "JMFINANCIL:90"
  "JUBILANT:650"
  "JUSTDIAL:750"
  "JYOTISTRUC:700"
  "KALPATECHW:2600"
  "KALYANKJIL:250"
  "KAMARAJS:1100"
  "KAMATHOTEL:500"
  "KAPL:650"
  "KATAPMILLS:800"
  "KAVERITEL:700"
  "KAYNES:7000"
  "KECL:300"
  "KEMINDUSTRI:700"
  "KESORAMIND:1050"
  "KHIMJIRAJI:1250"
  "KIRLOSKAR:1650"
  "KIRLOSKARP:8500"
  "KITEX:950"
  "KPITTECH:700"
  "KPTL:800"
  "KSHITIJPOL:850"
  "KSLINFRA:2700"
  "KSRMCERAM:1850"
  "KSTAR:1050"
  "KWALITY:500"
  "LABORTORY:3650"
  "LALPATHLAB:2650"
  "LAURUSLABS:650"
  "LAXMIMACH:4400"
  "LAXMTEXTIL:800"
  "LCI:450"
  "LEMONTREE:70"
  "LICHSGFIN:550"
  "LINKINTIME:700"
  "LNVGY:2100"
  "LSEG:7500"
  "LTFOODS:120"
  "LTIM:5250"
  "LTTS:4800"
  "LUMAXTECH:2300"
  "LUXIND:2400"
  "MAHABANK:95"
  "MAHALAXMI:1100"
  "MAHAPHI:50"
  "MAHAVIR:450"
  "MAHINDRA:2850"
  "MAHLOG:1050"
  "MAHSCOOTER:6200"
  "MANAPPURAM:150"
  "MANINDS:2150"
  "MANOMAHIND:1250"
  "MANORAMA:450"
  "MANSAINDS:550"
  "MANUGRAPH:2550"
  "MARATHON:850"
  "MARKSANS:550"
  "MASTCOMIND:750"
  "MASTEK:2300"
  "MATERWEBS:1900"
  "MAWPLAST:1050"
  "MAXHEALTH:950"
  "MAXINDUST:1350"
  "MAZAGON:2150"
  "MBIL:2450"
  "MCDOWELL_N:900"
  "MEDPRIME:250"
  "MEDTECH:1450"
  "MEGH:2100"
  "MEGASOFT:700"
  "MELSTAR:700"
  "METROBRAND:3150"
  "MFSL:1050"
  "MGL:1550"
  "MGCWIRE:700"
  "MICA:2650"
  "MICRO:1050"
  "MINDACORP:450"
  "MINDTECH:1900"
  "MINGLEND:500"
  "MINUETS:1250"
  "MIRAPAKAY:2750"
  "MIRC:550"
  "MIRFATIH:500"
  "MIRGOLD:500"
  "MIRON:1150"
  "MITTAL:750"
  "MITHQATAR:550"
  "MIYAPUR:1250"
  "MJ:5500"
  "MKPL:2900"
  "MLHC:3300"
  "MM:50"
  "MMTC:250"
  "MOBIMASK:550"
  "MOBISHOP:1750"
  "MOBILEIND:900"
  "MONEYWISE:1500"
  "MONTERUNN:1100"
  "MOODYBOARD:2600"
  "MOONDRAM:1200"
  "MOORMEDIC:750"
  "MORTHINDAL:500"
  "MOTILALFF:2000"
  "MOTILALOSL:700"
  "MOTOGFLEX:1250"
  "MSCHOICE:850"
  "MSPL:2550"
  "MSTCLTD:600"
  "MUL:1250"
  "MULTITECH:1950"
  "MUMMSUGR:800"
  "MUNICHOPAL:750"
  "MUNIRUDRAM:350"
  "MURUGAPPA:2400"
  "MURUDMED:650"
  "MUSIC:1550"
  "MUST:6800"
  "MYEMP:1050"
)

# Generate JSON for first 10 symbols (for quick test)
echo "Creating price data for test..."

JSON_DATA="{"
JSON_DATA+="\"symbol_prices\": {"

for i in {0..9}; do
    IFS=':' read -r symbol price <<< "${SYMBOLS[$i]}"
    if [ $i -gt 0 ]; then
        JSON_DATA+=","
    fi
    JSON_DATA+="\"$symbol\": $price"
done

JSON_DATA+="}"
JSON_DATA+="}"

echo "ðŸ“Š Testing with 10 symbols..."
echo "$JSON_DATA" | jq .

curl -s -X POST http://localhost:8000/api/v1/bracket-management/manual-init \
  -H "Content-Type: application/json" \
  -d "$JSON_DATA" | jq .

echo "\nâœ… Bracket selection test complete!"
